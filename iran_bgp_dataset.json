{
  "metadata": {
    "generated": "2026-01-13",
    "sources": [
      "RIPEstat API",
      "IODA (Georgia Tech)",
      "OONI Reports",
      "RIPE RIS"
    ],
    "description": "Iran Internet routing data for visualization"
  },

  "current_state": {
    "timestamp": "2026-01-13T14:30:00Z",
    "total_prefixes": 4026,
    "ris_visibility": {
      "peers_seeing": 320,
      "total_peers": 321,
      "percentage": 99.7
    },
    "status": "NORMAL",
    "asns": {
      "AS49666": {
        "name": "TIC-GW (Gateway)",
        "role": "international_gateway",
        "prefixes": 29,
        "upstreams": 12,
        "downstreams": 16,
        "first_seen": "2009-08-26"
      },
      "AS58224": {
        "name": "TIC (Main)",
        "role": "backbone",
        "prefixes": 1236,
        "upstreams": 3,
        "downstreams": 91,
        "first_seen": "2013-08-19"
      },
      "AS12880": {
        "name": "DCI",
        "role": "backbone",
        "prefixes": 75,
        "upstreams": 1,
        "downstreams": 21,
        "first_seen": "N/A"
      },
      "AS197207": {
        "name": "MCI (Mobile)",
        "role": "mobile_operator",
        "prefixes": 905,
        "upstreams": 1,
        "downstreams": 3,
        "first_seen": "2012-12-21"
      },
      "AS44244": {
        "name": "Irancell (Mobile)",
        "role": "mobile_operator",
        "prefixes": 461,
        "upstreams": 1,
        "downstreams": 1,
        "first_seen": "2007-12-18"
      },
      "AS31549": {
        "name": "Shatel",
        "role": "isp",
        "prefixes": 184,
        "upstreams": 2,
        "downstreams": 28,
        "first_seen": "N/A"
      },
      "AS42337": {
        "name": "Respina",
        "role": "isp",
        "prefixes": 723,
        "upstreams": 2,
        "downstreams": 147,
        "first_seen": "N/A"
      },
      "AS57218": {
        "name": "Rightel (Mobile)",
        "role": "mobile_operator",
        "prefixes": 90,
        "upstreams": 1,
        "downstreams": 2,
        "first_seen": "N/A"
      }
    },
    "international_upstreams": [
      {"asn": 6762, "name": "Telecom Italia Sparkle", "power": 57102},
      {"asn": 3257, "name": "GTT Communications", "power": 46388},
      {"asn": 33891, "name": "Core-Backbone", "power": 27906},
      {"asn": 5511, "name": "Orange S.A.", "power": 23254},
      {"asn": 6453, "name": "TATA Communications", "power": 19049},
      {"asn": 198150, "name": "Unknown", "power": 3887},
      {"asn": 3491, "name": "PCCW Global", "power": 3853},
      {"asn": 216067, "name": "Unknown", "power": 1426},
      {"asn": 39533, "name": "Unknown", "power": 1415},
      {"asn": 34984, "name": "Unknown", "power": 1335},
      {"asn": 286, "name": "KPN", "power": 176},
      {"asn": 29049, "name": "Delta Telecom", "power": 138447}
    ]
  },

  "historical_shutdowns": [
    {
      "id": "nov2019",
      "name": "November 2019 Shutdown",
      "start_date": "2019-11-16",
      "end_date": "2019-11-23",
      "duration_days": 7,
      "trigger": "Fuel price protests",
      "method": "BGP route withdrawal",
      "severity": "total",
      "timeline": [
        {"time": "2019-11-16T14:00Z", "event": "First BGP drop", "visibility_pct": 67, "detail": "33% drop, ~15000 /24s withdrawn"},
        {"time": "2019-11-16T17:00Z", "event": "Shatel drops", "visibility_pct": 40, "detail": "AS31549 disconnects"},
        {"time": "2019-11-16T18:00Z", "event": "ParsOnline drops", "visibility_pct": 25, "detail": "AS16322 disconnects"},
        {"time": "2019-11-16T20:00Z", "event": "Near-total shutdown", "visibility_pct": 8, "detail": "Most traffic blocked"},
        {"time": "2019-11-17T00:00Z", "event": "Full blackout", "visibility_pct": 5, "detail": "Minimal connectivity"},
        {"time": "2019-11-20T00:00Z", "event": "Lowest point", "visibility_pct": 5, "detail": "5% of normal"},
        {"time": "2019-11-21T09:00Z", "event": "Recovery begins", "visibility_pct": 20, "detail": "Gradual restoration"},
        {"time": "2019-11-23T10:50Z", "event": "Significant restoration", "visibility_pct": 90, "detail": "Most services back"}
      ],
      "affected_asns": ["AS58224", "AS12880", "AS31549", "AS16322", "AS44244", "AS197207"],
      "per_asn_timing": {
        "AS44244": {"drop_time": "14:00", "type": "mobile", "hours_after_start": 0},
        "AS197207": {"drop_time": "14:30", "type": "mobile", "hours_after_start": 0.5},
        "AS57218": {"drop_time": "15:00", "type": "mobile", "hours_after_start": 1},
        "AS31549": {"drop_time": "17:00", "type": "fixed", "hours_after_start": 3},
        "AS16322": {"drop_time": "18:00", "type": "fixed", "hours_after_start": 4},
        "AS58224": {"drop_time": "16:30", "type": "backbone", "hours_after_start": 2.5}
      },
      "data_sources": ["OONI", "IODA", "Kentik", "RIPE RIS"]
    },
    {
      "id": "sep2022",
      "name": "September 2022 Digital Curfew",
      "start_date": "2022-09-21",
      "end_date": "2022-10-03",
      "duration_days": 13,
      "trigger": "Mahsa Amini protests",
      "method": "Protocol-level blocking + time-based curfew",
      "severity": "partial_recurring",
      "pattern": {
        "daily_start_local": "16:00",
        "daily_end_local": "00:00",
        "hours_per_day": 8,
        "total_hours_offline": 100,
        "target": "mobile_networks"
      },
      "additional_measures": [
        {"date": "2022-09-20", "action": "Encrypted DNS (DoH) blocking"},
        {"date": "2022-09-21", "action": "WhatsApp, Instagram blocked"},
        {"date": "2022-09-22", "action": "HTTP/3, QUIC blocked"},
        {"date": "2022-09-22", "action": "App stores blocked"},
        {"date": "2022-09-23", "action": "Skype, Viber, LinkedIn blocked"},
        {"date": "2022-09-26", "action": "Browser extension repos blocked"}
      ],
      "affected_asns": ["AS44244", "AS197207", "AS57218"],
      "regional_outages": [
        {"region": "Kurdistan", "dates": ["2022-09-19", "2022-10-08", "2022-10-09"]},
        {"region": "Khuzestan", "dates": ["2022-10-16"]}
      ],
      "data_sources": ["OONI", "IODA"]
    }
  ],

  "architecture": {
    "description": "Centralized gateway model with single chokepoint",
    "chokepoint": "AS49666",
    "tiers": [
      {
        "tier": 1,
        "name": "International Gateway",
        "asns": ["AS49666"],
        "description": "All international traffic passes through TIC-GW"
      },
      {
        "tier": 2,
        "name": "Backbone Providers",
        "asns": ["AS58224", "AS12880", "AS42337", "AS48159"],
        "description": "Major infrastructure providers"
      },
      {
        "tier": 3,
        "name": "ISPs and Mobile Operators",
        "asns": ["AS197207", "AS44244", "AS31549", "AS25184", "AS43754", "AS57218"],
        "description": "End-user service providers"
      }
    ],
    "control_capabilities": {
      "total_shutdown": true,
      "selective_blocking": true,
      "time_based_curfew": true,
      "protocol_blocking": true,
      "dpi": true
    }
  },

  "evolution": [
    {"year": "early", "state": "initial", "international_gateways": 1, "gateways": ["IPM (AS6736)"], "shutdown_difficulty": "moderate"},
    {"year": "2000s", "state": "dual-gateway", "international_gateways": 2, "gateways": ["TIC (AS49666, AS12880, AS48159)", "IPM (AS6736)"], "shutdown_difficulty": "moderate"},
    {"year": 2017, "state": "controlled", "international_gateways": 2, "gateways": ["TIC", "IPM"], "shutdown_difficulty": "easy", "event": "NIN launched"},
    {"year": 2019, "state": "proven", "international_gateways": 2, "gateways": ["TIC", "IPM"], "shutdown_difficulty": "trivial", "event": "Nov shutdown proved capability"},
    {"year": 2022, "state": "optimized", "international_gateways": 2, "gateways": ["TIC", "IPM"], "shutdown_difficulty": "trivial", "event": "Stealth curfew method"},
    {"year": 2026, "state": "stealth", "international_gateways": 2, "gateways": ["TIC", "IPM"], "shutdown_difficulty": "trivial", "event": "Stealth outage - routes UP, traffic blocked"}
  ],

  "ripe_atlas": {
    "active_probes_in_iran": 0,
    "note": "No active RIPE Atlas measurement probes in Iran as of January 2026"
  }
}
